## 写在前边

整个暑假去面试，面试了很多家公司（无论是小厂还是大厂）问到的深度不同，网络原理是面试最容易问到的问题，虽然我们在项目中很少去实践它，但是了解其原理，会让我们背后网络通信是如果工作的，既能在面试官面前体现出你的基础是否扎实，也能对以后深入网络这部分学习有更多的了解。



很多同学面试在准备这部分的时候，都会去背，这部分确实很难掌握，我个人总结的最好的学习网络原理的方法就是不用刻意的去记忆而是完全的结合实际去讲整个原理融会贯通。虽然一开始学习起来很吃力，但是稍微用点心，多看几遍，多问自己为什么，把自己当做是开发网络原理的开发者，面试前的准备只要理清逻辑就足够了，而不是去背这部分内容。



而且这部分相同的知识点面试官有多种提问方式，但是其中很多都是换汤不换药。我记得最多的问的是输入URL，到页面呈现出来，其中经历了什么？这道面试题的背后，涉及到了很多网络原理的知识，我们这篇文章不会全部分享到，而是先把由来和网络层次划分弄清楚，就完成了这篇文章的目的。



## 一、为什么要进行网络层次划分？

说到网络层次划分并不陌生，我刚刚接触到网络层次的时候一脸懵逼，这么多层，一层不就行了嘛？层与层之间好多协议，还有各种数据包，第一次我放弃了。



当我从新拾起网络层次的时候，我下定决心从根上理解它。首先弄明白它的原理，那必定要知道它的由来，也就是为什么要进行网络层次划分？这个问题问的好。



假如“小鹿”是网络的开发人员，起初认为计算机与计算机之间的通信只需要一根线就可以完成通信，对没错，但是世界那么大，那么多计算机，距离又远，不但浪费线，还没出现各种线被你偷偷剪断的情况，毋庸置疑，那计算机之间通信就不行了。（后边出来了无线网，虽然其中网关、路由之间也需要连线，但不是让每台计算机两两连接，而是一个区域为单位计算机相互连接通信）



不行，老板说，“小鹿”你给我想法子改，改不出来今晚不能睡觉，“小鹿”仔细想了想，这还是个技术活，需要进行全面的改进，也发现所谓的计算机之间的连线只能传送0、1信号，另一台计算并不知道那么多0、1代表什么，而且“小鹿”又发现不同厂商的生产的计算机既然有连线实现通信也是很麻烦的，干脆定义一套规则吧，无论“某硕”计算机还是“某想”计算机，都必须遵守这套规则，其实所说的这套规则就是我们经常说的“网络协议”。



不是说网络层次的由来吗，怎么讲到网络协议了。咱们继续，通过上面的问题，那个计算机之间通过连线传送0、1信号的问题虽然规定了通信规则，但是除了像0、1这种无意义的信号之外，网络中还存在着其他各种各样的问题，两个计算机之间怎么进行识别？以及怎么才能知道对方的地址？以及不同计算机应用程序怎么知道是给自己传递的数据，还有不同的通信数据格式怎么来规定等等一系列的问题都出来了。




“小鹿”发现，如果各种问题都写成一套协议来规定双方通信的规则，但是呢？万一其中哪些规则通信中出现问题，影响到了其他规则，最常见的就是数据包，一个数据包中如果包含各种各样的协议，不就乱套了。


“小鹿”为了能够把它设计的更好，决定采用分层划分的结构，既能规定不同层的完成的功能，又能实现层与层之间的改动而不相互影响，这就是我们经常听到网络划分层次的好处。



## 二、 网络分层是如何进行分层的？

既然我们决定要分层，那么分为几层才好呢？


起初网络分层是标准的七层，也就是我们所说的 OSI 七层模型。

> 参考模型是国际标准化组织（ISO）制定的一个用于计算机或通信系统间互联的标准体系，一般称为OSI参考模型或七层模型。

![](https://user-gold-cdn.xitu.io/2019/9/3/16cf692d1539c275?w=359&h=534&f=png&s=79194)

我们所知道的还有 TCP/IP 四层模型和 TCP/IP 五层模型。这又是怎么出来的，其实所谓的 TCP/IP  四层模型和 TCP/IP 五层模型是以 OSI 七层优化而来，把某些层进行合并了，其实本质上还是相同的，但是我个人最喜欢用五层来解释。



![](https://user-gold-cdn.xitu.io/2019/9/3/16cf692fc7cc96f3?w=945&h=537&f=png&s=234451)



## 三、每一层的作用是什么？

这一部分涉及到每一层的很多协议和知识点，但是我们这一节不具体分享，为什么？我们具体深入之前必须大脑里有个具体的网络分层结构图，先要知道每层是做什么的，层与层之间的关系，然后下一节再深入每层中的每个协议怎么通信的，这样的好处学起来条理清晰，而不至于当时我学习的时候表面还不懂，就深入最后懵逼状态。



### 3.1 物理层

物理层，顾名思义，用物理手段将电脑连接起来，就像我们上边讲到的计算机之间的物理连线。主要用来传输0、1信号，上边也分析过了，0、1信号毕竟没有任何的现实意义，所有我们用另一层用来规定不同0、1组合的意义是什么。



### 3.2 数据链路层

下层的物理层既然不能规定不同0、1组合的信号代表什么意义，那么我们在数据链路层规定一套协议，专门的给0、1信号进行分组，以及规定不同的组代表什么意思，从而双方计算机都能够进行识别，这个协议就是“以太网协议”（具体的以太网协议内容下节内容详细讲解）。

但是问题又来了，我们要发送给对方计算机，怎么标识对方以及怎么知道对方的地址呢？



#### 3.2.1 MAC 地址

我们所说的MAC地址到底的作用是啥？说白了它就是作为网络中计算机设备的唯一标识，从计算机在厂商生产出来就被十六进制的数标识为MAC地址。


既然我们知道了用MAC地址作为标识，那么怎么才能知道我们要进行通信的计算机MAC地址呢？



#### 3.2.2 广播

这里广播详细的在下一节讲，这一节你只需要知道广播可以帮助我们能够知道对方的 MAC 地址。那么既然知道了MAC地址就可以通信了？没有想得那么简单，广播中还存在两种情况，一种是，在同一子网络下（同一局域网下）的计算机是通过 ARP 协议获取到对方 MAC地址的。不同自网络中（不同局域网）中是交给两个局域网的网关（路由器）去处理的。这里边涉及到很多细节的知识，都会集中到下一节，但是这一节你了解怎么进行标识计算机和怎么获取到MAC地址就可以了。



### 3.3 网络层

物理层和数据链路层都有自己的事情要做，也就是我们上边所讲到的这些（里边很多细节不在这节多说）。上边两层在我看来可以完成正常通信了，那么网络层出来干啥子？


网络层的由来是因为在数据链路层中我们说说两台计算机之间的通信是分为同一子网络和不同子网络之间，那么问题就来了，怎么判断两台计算机是否在同一子网络（局域网）中？这就是网络层要解决的问题。



#### 3.3.1 IP 协议

我们通常用到的 IP 地址，就是网络层中的东西，所规定的的协议就是 IP 协议。很多小伙伴问，IP 地址想必也是地址吧，上边都有唯一标识的 MAC 地址了，IP 地址出来是混饭吃的？为了能够让大家更方便的理解 IP 地址和 MAC 地址，我们可以将 IP 地址抽象成一种逻辑上的地址，也就是说 MAC 地址是物理上的地址，就是定死了。IP 地址呢，是动态分配的，不是固定死的。


我们就是通过 IP 地址来判断两个计算机设备是否在同一子网络中的，那么你会问它是怎么判断的，以及 IP 地址谁给他分配的？又是如何分配的等一些列问题，我们不着急，这里只说一下大体的流程，详细会后续写一大篇。


既然我们通过 IP 地址来判断两个计算机是否处于同一局域网中，那么首先要知道对方的 IP 地址吧？DNS 解析想必大家都知道，可以将域名解析为 IP 地址。好了，我们知道两台计算机的 IP 地址了，怎么进行判断是否同一局域网中？



#### 3.3.2 子网掩码

嘿嘿，又是一个只听说过，但是不知道这个什么作用的一个名词，没事，等我聊完，你就明白是做什么的了。


子网掩码就是用来标识同一局域网中的 IP 地址的信息的？什么信息？IP 地址是由 32 个二进制位组成的，也就是四个十进制（如：255.255.255.000）。


子网掩码也是由 32 个二进制位组成的，但是只能用 0 或 1 来表示，如11111111.11111111.11111111.00000000。


到底什么意思呢？有 1 的部分表示网络部分，有 0 表示主机部分，这和判断两台计算机是否在同一局域网中有什么关系？没错，是有关系的！两台计算机的 IP 地址分别和子网掩码进行一种运算（AND 运算），如果结果相同，两台计算机就在同一局域网中，否则就不在同一局域网中。


AND 是如何进行运算的，IP 的数据包的组成等问题，不在这里多陈述。



### 3.4 传输层

好了，如果你认为计算机可以进行通信了，那么“小鹿”恭喜你，你已经基本知道了以上几层划分的作用，但是如果你正在一边打 LOL，一边和朋友在 QQ 聊天，突然，游戏中队友聊天信息出现在了 QQ 窗口中，咦？出现了什么情况?


其实是以上层级还是不够，出现上边的原因就是，两台计算机虽然可以通信了，但是每天计算机运行着好多的程序，谁知道你们传输的信息是属于哪些程序的，怨不得 LOL 的聊天信息跑到了 QQ 窗口中。


想必大家猜到了传输层主要用来干啥滴，是的，传输层的主要功能就是为了能够实现“端口到端口”的通信。计算机上运行的不同程序都会分配不同的端口，所以才能使得数据能够正确的传送给不同的应用程序。



#### 3.4.1 UDP 协议

加入端口号也需要一套规则，那就是 UDP 协议，但是 UDP协议有个缺点，一旦进行通信，就不知道对方是否接收到数据了，我们再定义一套规则，让其可以和对方进行确认，那么 TCP 出现了。



#### 3.4.2 TCP 协议

我们通常说 TCP 三次握手和四次挥手，没错，这就是传输层中完成的，TCP 三次握手涉及到的内容贼多，都可以单独写一篇长文，这里不多陈述，知道它是在传输层中完成的以及它的作用是什么，能够认识到它就好了。



### 3.5 应用层协议

“喂，你发给我的是什么破数据，乱七八糟的，我TM能解析吗？能不能按照我的规定给我传送？“


“好的，下次不敢了”


想必大家已经猜到了应用层的协议，应用层的功能就是规定了应用程序的数据格式。我们经常用得到的电子邮件、HTTP协议、以及FTP数据的格式，就是在应用层定义的。

**如果觉得本文对你有帮助，点个赞，我希望能够让更多处在递归困惑的人看到，谢谢各位支持！**下一篇我打算出一篇完整关于链表的文章，终极目标：将数据结构与算法每个知识点写成一系列的文章。

<hr>
**作者：**小鹿

**座右铭：**追求平淡不平凡，一生追求做一个不甘平凡的码农!

**个人公众号：一个不甘平凡的码农。**



### 其他链接：

#### [1、LeetCode 30 道经典题详细解析](https://github.com/luxiangqiang/JS-LeetCode)

#### [2、Github：入门必会的基本数据结构与算法代码剖析](https://github.com/luxiangqiang/Data-Structure-Coding)

#### [3、Github：公众号留言小程序开源项目](https://github.com/luxiangqiang/WeiXin_MessageApplet)




